---
title: 跨域
date: 2021-05-17 10:28:59
tags:
categories:
---

## 同源策略

[MDN 同源策略](https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy)

**浏览器的同源策略一直是开发中经常遇到的问题,它是浏览器最核心也是最基本的安全功能,如果缺少了同源策略,则浏览器的正常功能都会受到影响**

域名、协议、端口相同则为同源

这个策略可以阻止一个页面上的恶意脚本通过页面的DOM对象获得访问另一个页面上敏感信息的权限

是为了保护用户的信息安全,为了防止恶意网站窃取用户在浏览器上的数据,如果`不是同源`的站点,将不能进行如下操作 :

- Cookie、LocalStorage 和 IndexDB 无法读写
- DOM 和 Js对象无法获得
- AJAX请求不能发送

出现跨域请求时,请求会发到跨域的服务器,并且会服务器会返回数据,只不过浏览器"拒收"返回的数据

# 跨域

前端调用的后端接口不属于同一个域（域名或端口不同），就会产生跨域问题，也就是说应用访问了该应用域名或端口之外的域名或端口。

# 解决跨域

- 浏览器解除跨域限制
- JSONP
- 服务端修改

## 浏览器解除跨域限制

浏览器默认都是开启跨域安全检查的，我们可以使用命令行启动浏览器，加上禁止安全检查的参数

## JSONP

ajax请求受同源策略影响，不允许进行跨域请求，而script标签src属性中的链接却可以访问跨域的js脚本，利用这个特性，服务端不再返回JSON格式的数据，而是返回一段调用某个函数的js代码，在src中进行了调用，这样实现了跨域

JSONP 的工作原理是什么？ - 贺师俊的回答 - 知乎 https://www.zhihu.com/question/19966531/answer/13502030

缺点：

- 只支持GET方式
- 需要服务端配合修改
- 发送的不是 XHR 请求，无法使用 XHR 对象

## 服务端修改

### CORS

Cross-Origin Resource Sharing

[阮一峰 cors](http://www.ruanyifeng.com/blog/2016/04/cors.html)

### 反向代理

跨域只是浏览器向服务器发送请求的时候，浏览器的限制。而服务器和服务器之间是没有跨域的限制的。

反向代理是利用代理服务器接收到请求之后，转发给真正的服务器，并把结果返回到浏览器上。

vue中配置：

```js
module.exports = {
  devServer: {
    proxy: {
      '^/': {
        target: 'http://localhost:8082/' // api server
      }
    }
  }
}
```

